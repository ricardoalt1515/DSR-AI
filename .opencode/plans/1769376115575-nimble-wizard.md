# Intake Panel: SuggestionRow Redesign

**Status**: Ready to implement  
**Scope**: Value-first 2-line layout, remove visual noise

---

## Current vs New Layout

```
CURRENT (4 rows, 56px+)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â˜ Field Name                                      [âœ“][âœ—]â”‚
â”‚   Section Â· â—â—â—â—‹ 87%                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚ "Extracted Value Here"                        â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚   ğŸ“„ source-file.pdf                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

NEW (2 rows, ~40px)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â˜ "Extracted Value Here"                          [âœ“][âœ—]â”‚
â”‚   Field Name Â· 94% Â· ğŸ“„                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Changes

### 1. suggestion-row.tsx - Restructure

**Remove**: `ConfidenceDots` component (lines 25-66)

**Reuse**: `ConfidenceBadge` from `./confidence-badge` (already has colored % + shape indicator for colorblind a11y)

**Add**: `SourceBadge` - icon only, tooltip shows details:
```tsx
interface SourceBadgeProps {
  sourceFileId: string | null | undefined;
  filename?: string;
}

function SourceBadge({ sourceFileId, filename }: SourceBadgeProps) {
  const isFromNotes = !sourceFileId;
  const Icon = isFromNotes ? StickyNote : FileText;
  const label = isFromNotes ? "From notes" : filename ?? "From document";
  
  return (
    <Tooltip>
      <TooltipTrigger asChild>
        <span className="inline-flex items-center" aria-label={label}>
          <Icon className="h-3 w-3 text-muted-foreground" aria-hidden />
          <span className="sr-only">{label}</span>
        </span>
      </TooltipTrigger>
      <TooltipContent side="top">{label}</TooltipContent>
    </Tooltip>
  );
}
```

**Restructure layout** (lines 200-305):
```tsx
<motion.div ...>
  {/* Row 1: Checkbox + Value + Actions */}
  <div className="flex items-center gap-2">
    <Checkbox ... className="shrink-0" />
    <ValueBadge value={formattedValue} ... className="flex-1 min-w-0" />
    <div className="flex shrink-0 gap-1 ...">
      {/* Apply/Reject buttons */}
    </div>
  </div>
  
  {/* Row 2: Field Â· Confidence Â· Source */}
  <div className="ml-6 mt-1 flex items-center gap-1.5 text-xs text-muted-foreground">
    <span className="truncate">{suggestion.fieldLabel}</span>
    <span>Â·</span>
    <ConfidenceText confidence={suggestion.confidence} />
    <span>Â·</span>
    <SourceBadge suggestion={suggestion} />
  </div>
</motion.div>
```

**Remove**:
- Row 2 (section title) - redundant, suggestions already grouped by section
- Row 4 (source filename) - replaced by source badge icon
- `ConfidenceDots` component entirely

**Simplify ValueBadge**:
- Remove border, keep bg-primary/10
- Inline in row 1 instead of separate row

---

## File: `suggestion-row.tsx`

### Imports
```tsx
// Add
import { StickyNote } from "lucide-react";
import { ConfidenceBadge } from "./confidence-badge";

// Remove FileText from lucide (only used in Row 4, now in SourceBadge)
```

### Components to remove
- `ConfidenceDots` (lines 25-66)
- `ConfidenceDotsProps` interface

### Components to add
- `SourceBadge` (~20 lines)

### Main layout changes (lines 200-305)
Row 1: checkbox + value badge + actions
Row 2: field label + ConfidenceBadge + SourceBadge
Delete: Row 3 (old value), Row 4 (source file details)

---

## Checklist

```
[ ] Delete ConfidenceDots + ConfidenceDotsProps (L25-66)
[ ] Add import: StickyNote from lucide-react
[ ] Add import: ConfidenceBadge from ./confidence-badge
[ ] Create SourceBadge subcomponent
[ ] Restructure: value â†’ row 1, metadata â†’ row 2
[ ] Remove sectionTitle from row 2 (redundant)
[ ] Remove Row 4 (source file details)
[ ] Test: flying animation still works in new position
[ ] Run: cd frontend && bun run check:ci
```

---

## Verification

1. Visual: value is hero in row 1, metadata in row 2
2. Source badge: StickyNote for notes, FileText for docs
3. Hover source badge â†’ shows filename/"From notes"
4. Confidence: colored % with shape indicator (existing ConfidenceBadge)
5. Apply/reject buttons work
6. Batch selection (checkbox) works  
7. Flying animation works from new position
8. Mobile: touch targets adequate
9. `cd frontend && bun run check:ci`
